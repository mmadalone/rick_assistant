# Rick Assistant Powerlevel10k Integration

This guide explains the Rick Assistant integration with Powerlevel10k, which adds system metrics and Rick-themed content to your ZSH prompt.

## Overview

The integration adds a custom segment to Powerlevel10k that displays:
- CPU usage (üñ•Ô∏è CPU:x.x%)
- RAM usage (üîß RAM:x.x%)
- CPU temperature if available (üå°Ô∏è xx¬∞C)
- Universe designation (üåÄ C-137)
- Rick quotes (üß™ *burp*)

This implementation follows Powerlevel10k's official guidelines for custom segments and is designed to work across different Linux distributions, including WSL environments.

## Files

- `~/.rick-p10k-segment.zsh`: Defines the segment function for Powerlevel10k
- `~/.rick-p10k-integration.zsh`: Handles integration with Powerlevel10k
- `~/.rick-wsl-fix.zsh`: Contains WSL-specific fixes for PATH and command resolution
- `~/.rick-distro-detect.zsh`: Detects Linux distribution and applies appropriate fixes
- `~/.rick-p10k-diagnostics.zsh`: Diagnostic tool to troubleshoot integration issues
- `~/.rick-zshrc-instructions.txt`: Instructions for updating `.zshrc`

## Installation

1. Make sure all scripts are executable:
   ```bash
   chmod +x ~/.rick-*.zsh
   ```

2. Update your `.zshrc` file to source the integration scripts after sourcing `.p10k.zsh`:
   ```bash
   # Load Rick Assistant Powerlevel10k integration
   [[ -f ~/.rick-wsl-fix.zsh ]] && source ~/.rick-wsl-fix.zsh
   [[ -f ~/.rick-distro-detect.zsh ]] && source ~/.rick-distro-detect.zsh
   [[ -f ~/.rick-p10k-integration.zsh ]] && source ~/.rick-p10k-integration.zsh
   ```

3. Remove or comment out any previous Rick Assistant p10k integration code

4. Apply the changes by restarting your shell:
   ```bash
   exec zsh
   ```

## How It Works

1. **Distribution Detection**: The integration detects your Linux distribution to apply appropriate fixes
2. **WSL Fixes**: If running in WSL, special fixes are applied to ensure command resolution works correctly
3. **Segment Definition**: Defines a custom segment function compatible with Powerlevel10k's APIs
4. **Segment Registration**: Adds the segment to your Powerlevel10k right prompt elements
5. **System Metrics**: Collects system metrics using cross-platform methods with fallbacks

## Troubleshooting

### Statusbar Not Showing

1. Make sure you've run `p10k configure` to create a fresh configuration
2. Verify that all scripts are executable: `chmod +x ~/.rick-*.zsh`
3. Ensure the integration scripts are sourced AFTER `.p10k.zsh` in your `.zshrc`
4. Check for errors using the diagnostic tool: `source ~/.rick-p10k-diagnostics.zsh`

### "p10k segment: can be called only during prompt rendering" Error

This error occurs when the `p10k segment` command is used outside of prompt rendering context. The integration is designed to avoid this error by:

1. Only defining the segment function without directly calling it
2. Letting Powerlevel10k call the segment function during prompt rendering
3. Using the proper naming convention for custom segments

If you still see this error:
1. Enable debug mode: `export RICK_P10K_DEBUG=true`
2. Reload your shell: `exec zsh`
3. Check the debug output for clues

### Command Not Found Errors in WSL

These errors typically occur due to PATH issues in WSL. The integration includes fixes for these by:

1. Ensuring Linux paths have priority over Windows paths
2. Setting up proper environment variables
3. Creating fallbacks for common commands

If issues persist:
1. Check the PATH variable: `echo $PATH`
2. Make sure Linux paths come first
3. Run the diagnostic tool to verify command availability

## Advanced Configuration

### Enable Debug Mode

To enable detailed debug output:
```bash
export RICK_P10K_DEBUG=true
exec zsh
```

### Custom Integration

If you want to customize the integration, you can edit the `.rick-p10k-segment.zsh` file to:
- Change the Rick phrases
- Modify the format of the segment
- Adjust CPU/RAM/temperature display
- Change colors or styling

## Compatibility

This integration has been designed to work across:
- Different Linux distributions
- WSL environments
- macOS (with limited metrics support)

It includes multiple fallback mechanisms to ensure it works even if some commands are not available. 